# Решение

## Выбор БД по сервисам

### Auth Service
- **Данные**: playerId, сессии, токены, права доступа
- **Требования**:
  - Высокая доступность
  - Низкая задержка при проверке авторизации
- **Выбор БД**:
  - Основная: Greenplum
  - Кеш: Redis (сессии)
- **Масштабирование**: Репликация Greenplum

### Chat Service
- **Данные**: сообщения, комнаты, участники
- **Требования**:
  - 1000 msg/sec
  - Задержка <200ms
- **Выбор БД**:
  - Основная: MongoDB
  - Кеш: Redis (последние сообщения)
- **Масштабирование**: Шардинг по roomId

### Moderation Service
- **Данные**: блокировки, жалобы, фильтры слов
- **Требования**:
  - Быстрый поиск нарушений
  - Сложные аналитические запросы
- **Выбор БД**:
  - Основная: Greenplum
  - Поиск: Elasticsearch
- **Масштабирование**: Сегментирование Greenplum

### Notification Service
- **Данные**: уведомления
- **Требования**:
  - Минимальная задержка
  - Высокий RPS
- **Выбор БД**: Redis Pub/Sub
- **Масштабирование**: Redis Cluster

### Admin Service
- **Данные**: логи, метрики, бэкапы
- **Требования**:
  - Надежное хранение
  - Сложная аналитика
- **Выбор БД**: Greenplum
- **Масштабирование**: Сегментирование

### Search Service
- **Данные**: индексы чатов
- **Требования**:
  - Full-text поиск
  - Фильтрация
- **Выбор БД**: Elasticsearch
- **Масштабирование**: Автошардинг

### Storage Service
- **Данные**:
  - Горячие: сообщения (30 дней)
  - Холодные: архивы
- **Требования**:
  - Быстрый доступ к свежим данным
  - Дешевое хранение архивов
- **Выбор БД**:
  - Горячие: MongoDB
  - Холодные: Greenplum (аналитика) + S3
- **Масштабирование**: Шардинг + сегментирование

## Итоговая схема

| Сервис          | Основная БД       | Доп. БД          | Масштабирование        |
|----------------|------------------|-----------------|------------------------|
| Auth           | Greenplum        | Redis           | Сегментирование        |
| Chat           | MongoDB          | Redis+Greenplum | Шардинг                |
| Moderation     | Greenplum        | Elasticsearch   | Сегментирование        |
| Notification   | Redis            | -               | Cluster                |
| Admin          | Greenplum        | -               | Сегментирование        |
| Search         | Elasticsearch    | -               | Автошардинг            |
| Storage        | MongoDB          | Greenplum+S3    | Шардинг+Сегментирование|

